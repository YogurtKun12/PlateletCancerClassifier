q()
q()
q()
# ------------------- Run App -------------------
shinyApp(ui = ui, server = server)
install.packages(c("shiny", "DT", "ggplot2", "dplyr", "shinythemes"))
example_data <- data.frame(
Sample = paste0("S", 1:20),
GeneA = rnorm(20, 50, 15),
GeneB = rnorm(20, 30, 10),
Group = rep(c("Control", "Treatment"), each = 10),
Predicted_Class = sample(c("Responsive", "Non-responsive"), 20, replace = TRUE)
)
install.packages(c("shiny", "DT", "ggplot2", "dplyr", "shinythemes"))
# app.R - BIO215 Coursework 2: Full Shiny App (Session 5 + Session 6)
library(shiny)
library(DT)
library(ggplot2)
library(dplyr)
# ------------------- 模拟数据（可替换为你的真实数据） -------------------
set.seed(123)
example_data <- data.frame(
Sample = paste0("S", 1:20),
GeneA = rnorm(20, 50, 15),
GeneB = rnorm(20, 30, 10),
Group = rep(c("Control", "Treatment"), each = 10),
Predicted_Class = sample(c("Responsive", "Non-responsive"), 20, replace = TRUE)
)
# 模拟预测模型（简单逻辑回归示例）
predict_multiple <- function(data, geneA_col, geneB_col) {
data %>%
mutate(
logit = -2 + 0.1 * .data[[geneA_col]] - 0.08 * .data[[geneB_col]] + rnorm(n(), 0, 0.5),
Probability = plogis(logit),
Predicted_Class = ifelse(Probability > 0.5, "Responsive", "Non-responsive")
) %>%
select(Sample, all_of(c(geneA_col, geneB_col)), Probability, Predicted_Class)
}
predict_single <- function(geneA, geneB) {
logit <- -2 + 0.1 * geneA - 0.08 * geneB
prob <- plogis(logit)
class <- ifelse(prob > 0.5, "Responsive", "Non-responsive")
data.frame(GeneA = geneA, GeneB = geneB, Probability = round(prob, 3), Predicted_Class = class)
}
# ------------------- UI -------------------
ui <- navbarPage(
title = "BIO215 Coursework 2: Gene Expression Analyzer",
theme = shinythemes::shinytheme("flatly"),
# ===== 1. Home Page =====
tabPanel("Home",
fluidPage(
titlePanel("Welcome to Gene Expression Dashboard"),
p("This app integrates data upload, visualization, download, and predictive modeling."),
tags$ul(
tags$li("Upload CSV with gene expression data"),
tags$li("Explore data in table and plots"),
tags$li("Download results"),
tags$li("Predict treatment response for multiple or single samples")
),
br(),
img(src = "https://www.rstudio.com/wp-content/uploads/2014/06/shiny.png", height = "100px")
)
),
# ===== 2. Data Table Page =====
tabPanel("Data Table",
sidebarLayout(
sidebarPanel(
fileInput("file", "Upload CSV File", accept = ".csv"),
checkboxInput("header", "Header", TRUE),
radioButtons("sep", "Separator", choices = c(Comma = ",", Semicolon = ";", Tab = "\t"), selected = ",")
),
mainPanel(
DT::dataTableOutput("table")
)
)
),
# ===== 3. Visualization Page =====
tabPanel("Visualization",
sidebarLayout(
sidebarPanel(
uiOutput("var_x"),
uiOutput("var_y"),
uiOutput("var_color"),
sliderInput("point_size", "Point Size", 1, 10, 3)
),
mainPanel(
plotOutput("scatterplot", height = "500px"),
downloadButton("download_plot", "Download Plot")
)
)
),
# ===== 4. Download Page =====
tabPanel("Download",
fluidPage(
h3("Download Processed Data & Plots"),
downloadButton("download_data", "Download Current Data (CSV)"),
br(), br(),
downloadButton("download_plot2", "Download Latest Plot (PNG)"),
br(), br(),
p("Note: Only the latest scatterplot is available for download.")
)
),
# ===== 5. Prediction (Multiple) =====
tabPanel("Prediction (Multiple)",
sidebarLayout(
sidebarPanel(
uiOutput("geneA_select"),
uiOutput("geneB_select"),
actionButton("predict_multi", "Run Prediction", class = "btn-primary")
),
mainPanel(
h4("Prediction Results"),
DT::dataTableOutput("pred_multi_table"),
downloadButton("download_pred_multi", "Download Predictions")
)
)
),
# ===== 6. Prediction (Single) =====
tabPanel("Prediction (Single)",
fluidPage(
titlePanel("Single Sample Prediction"),
sidebarLayout(
sidebarPanel(
numericInput("single_geneA", "Gene A Expression", value = 50, min = 0),
numericInput("single_geneB", "Gene B Expression", value = 30, min = 0),
actionButton("predict_single", "Predict", class = "btn-success")
),
mainPanel(
h4("Prediction Result"),
tableOutput("pred_single_table")
)
)
)
)
)
# ------------------- SERVER -------------------
server <- function(input, output, session) {
# Reactive data
data <- reactive({
if (!is.null(input$file)) {
read.csv(input$file$datapath, header = input$header, sep = input$sep)
} else {
example_data
}
})
# ===== Data Table =====
output$table <- DT::renderDataTable({
DT::datatable(data(), options = list(pageLength = 10, scrollX = TRUE))
})
# ===== Dynamic UI for Visualization =====
output$var_x <- renderUI({
selectInput("x_var", "X-axis Variable", choices = names(data()))
})
output$var_y <- renderUI({
selectInput("y_var", "Y-axis Variable", choices = names(data()))
})
output$var_color <- renderUI({
selectInput("color_var", "Color by", choices = c("None", names(data())), selected = "Group")
})
# ===== Scatterplot =====
current_plot <- reactive({
req(input$x_var, input$y_var)
p <- ggplot(data(), aes_string(x = input$x_var, y = input$y_var)) +
geom_point(aes_string(color = if(input$color_var != "None") input$color_var else NULL),
size = input$point_size, alpha = 0.7) +
theme_minimal() +
labs(title = paste(input$y_var, "vs", input$x_var))
if(input$color_var != "None") p <- p + labs(color = input$color_var)
p
})
output$scatterplot <- renderPlot({
current_plot()
})
# Download plot
output$download_plot <- downloadHandler(
filename = function() { "scatterplot.png" },
content = function(file) {
ggsave(file, current_plot(), device = "png", width = 10, height = 6)
}
)
output$download_plot2 <- downloadHandler(
filename = function() { "scatterplot.png" },
content = function(file) {
ggsave(file, current_plot(), device = "png", width = 10, height = 6)
}
)
# ===== Download Data =====
output$download_data <- downloadHandler(
filename = function() { "processed_data.csv" },
content = function(file) {
write.csv(data(), file, row.names = FALSE)
}
)
# ===== Prediction Multiple =====
output$geneA_select <- renderUI({
selectInput("geneA_col", "Select Gene A", choices = names(data()))
})
output$geneB_select <- renderUI({
selectInput("geneB_col", "Select Gene B", choices = names(data()))
})
pred_multi <- eventReactive(input$predict_multi, {
req(input$geneA_col, input$geneB_col)
predict_multiple(data(), input$geneA_col, input$geneB_col)
})
output$pred_multi_table <- DT::renderDataTable({
DT::datatable(pred_multi(), options = list(pageLength = 10))
})
output$download_pred_multi <- downloadHandler(
filename = "predictions_multiple.csv",
content = function(file) {
write.csv(pred_multi(), file, row.names = FALSE)
}
)
# ===== Prediction Single =====
pred_single <- eventReactive(input$predict_single, {
predict_single(input$single_geneA, input$single_geneB)
})
output$pred_single_table <- renderTable({
pred_single()
}, digits = 3)
}
# ------------------- Run App -------------------
shinyApp(ui = ui, server = server)
# ------------------- Run App -------------------
shinyApp(ui = ui, server = server)
shinyApp(ui, server)
library(shiny)
shinyApp(ui = ui, server = server)
rsconnect::setAccountInfo(name='xiaokunxi812', token='A0F47BC3454705F2E7A539AF7CBF0D38', secret='t2v4jtIx1Ky6t1Af6qvHEX0fkHFmtGJm4SpBd+ht')
library(rsconnect)
rsconnect::setAccountInfo(name='xiaokunxi812', token='A0F47BC3454705F2E7A539AF7CBF0D38', secret='t2v4jtIx1Ky6t1Af6qvHEX0fkHFmtGJm4SpBd+ht')
# ------------------- 运行 -------------------
shinyApp(ui = ui, server = server)
# 3. 部署（确保当前工作目录就是放 app.R 的文件夹）
rsconnect::deployApp(appName = "bio215-m6a",   # 自定义名字，可改
appTitle = "m6A Prediction Server")
appTitle = "m6A Prediction Server")
# 1. 安装 rsconnect（只需要一次）
install.packages("rsconnect")
# 2. 加载并登录（只做一次）
library(rsconnect)
rsconnect::setAccountInfo(
name   = 'xiaokunxi812',                         # 你的用户名
token  = 'A0F47BC3454705F2E7A539AF7CBF0D38',   # 你的 Token
secret = 't2v4jtIx1Ky6t1Af6qvHEX0fkHFmtGJm4SpBd+ht'  # 你的 Secret
)
# 3. 部署（确保当前工作目录就是放 app.R 的文件夹）
rsconnect::deployApp(appName = "bio215-m6a",   # 自定义名字，可改
appTitle = "m6A Prediction Server")
# 1. 安装 rsconnect（只需要一次）
install.packages("rsconnect")
# 2. 加载并登录（只做一次）
library(rsconnect)
rsconnect::setAccountInfo(
name   = 'xiaokunxi812',                         # 你的用户名
token  = 'A0F47BC3454705F2E7A539AF7CBF0D38',   # 你的 Token
secret = 't2v4jtIx1Ky6t1Af6qvHEX0fkHFmtGJm4SpBd+ht'  # 你的 Secret
)
setwd("D：/BIO215/Practical7")          # 改成你自己的路径！
# 基本摘要
summary(abalone)
# 现在运行基本摘要
summary(abalone)
getwd()
# 需要先安装 remotes（如果没有）
install.packages("remotes")
# 从GitHub安装
remotes::install_github("你的GitHub用户名/PlateletCancerClassifier")
# 进入你的包文件夹
setwd("D:/PlateletCancerClassifier")
# 初始化 Git 仓库
system("git init")
# 添加所有文件
system("git add .")
# 提交
system("git commit -m \"initial commit: add PlateletCancerClassifier package\"")
# 连接到你的 GitHub 仓库
system("git remote add origin https://github.com/YogurtKun12/PlateletCancerClassifier.git")
# 推送（第一次要用 -u）
system("git push -u origin main")
